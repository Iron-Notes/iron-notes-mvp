<link rel="stylesheet" href="/stylesheets/modal.css">

<a href="/notes/create" class="btn btn-outline-primary m-2" data-bs-toggle="modal" data-bs-target="#modal-create">
    <h3 class="d-flex fa-regular fa-note-sticky">
        <p>Add Note</p>
    </h3>
</a>
<div class="row">
    {{#each notes}}
    <div class="col-xl-2 col-lg-3 col-md-6 col-sm-12 pt-3">
        <div class="card" style="max-height: 20vh; overflow-y: auto">
            <div class="d-flex justify-content-end">
                <button id="btn-edit" class="btn btn-outline-warning fa-regular fa-pen-to-square m-1"
                    data-bs-toggle="modal" data-bs-target="#modal-edit"></button>
                <a href="/notes/trash" class="btn btn-outline-danger fa-regular fa-trash-can m-1"></a>
            </div>
            <div class="card-body">
                <h5 id="edit-card-title" class="card-title">{{this.title}}</h5>
                <hr>
                <p id="edit-card-note" class="card-text">{{this.description}}</p>
            </div>
        </div>
    </div>
    {{/each}}
</div>

<form method="post" action="/notes/create">
    <div class="modal fade" id="modal-create">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen-md-down">
            <div class="modal-content">
                <div class="modal-header">
                    <input class="modal-input" type="text" name="title" placeholder="Title"></input>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                        data-bs-target="#modal-create"></button>
                </div>
                <div class="modal-body">
                    <textarea class="modal-textarea" name="description" rows="10" placeholder="Note"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit"
                        class="btn btn-outline-success fa-regular fa-pen-to-square m-1 fa-regular fa-floppy-disk"></button>
                </div>
            </div>
        </div>
    </div>
</form>

<form method="post" action="/notes/{{this._id}}/edit">
    <div class="modal fade" id="modal-edit">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen-md-down">
            <div class="modal-content">
                <div class="modal-header">
                    <input id="edit-modal-title" class="modal-input" type="text" name="title" placeholder="Title">
                    <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#modal-edit"></button>
                </div>
                <div class="modal-body">
                    <textarea id="edit-modal-note" class="modal-textarea" name="note" rows="10"
                        placeholder="Note"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit"
                        class="btn btn-outline-success fa-regular fa-pen-to-square m-1 fa-regular fa-floppy-disk"></button>
                </div>
            </div>
        </div>
    </div>
</form>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Get all the necessary elements
        var btnEditList = document.querySelectorAll("#btn-edit");
        var editCardTitleList = document.querySelectorAll("#edit-card-title");
        var editCardNoteList = document.querySelectorAll("#edit-card-note");
        var editModalTitle = document.getElementById("edit-modal-title");
        var editModalNote = document.getElementById("edit-modal-note");

        // Add click event listener to each button
        btnEditList.forEach(function (btnEdit, index) {
            btnEdit.addEventListener("click", function () {
                // Get the corresponding card title and note and copy it to the modals
                var cardTitle = editCardTitleList[index].innerText;
                var cardNote = editCardNoteList[index].innerText;
                editModalTitle.value = cardTitle;
                editModalNote.value = cardNote;
            });
        });
    });
</script>